package repository

import (
	"github.com/dmitriivoitovich/test-assignment-malwarebytes/repository/db"
	uuid "github.com/satori/go.uuid"
	"gorm.io/gorm"
)

type Event struct {
	db *gorm.DB
}

func NewEvent(db *gorm.DB) *Event {
	return &Event{
		db: db,
	}
}

func (e *Event) Insert(event *db.Event) error {
	return e.db.Create(event).Error
}

func (e *Event) ByID(id uuid.UUID) (*db.Event, error) {
	event := &db.Event{}

	if err := e.db.Where("id = ?", id.Bytes()).First(event).Error; err != nil {
		return nil, err
	}

	return event, nil
}
